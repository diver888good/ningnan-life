<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å®å—ç”Ÿæ´»å¹³å° - æœ€ç»ˆå…¨èƒ½ç‰ˆ</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:"Microsoft YaHei",sans-serif;}
body{background:#f8f9fa;color:#222;line-height:1.6;}
.top-bar{background:#d32f2f;color:#fff;padding:6px 0;text-align:center;font-size:13px;}
.header{background:linear-gradient(135deg,#e53535,#c62828);color:#fff;padding:28px 10px;text-align:center;}
.header h1{font-size:34px;margin-bottom:8px;}
.banner{background:#ff6c00;color:#fff;padding:10px;text-align:center;font-weight:bold;font-size:15px;}
.slide{width:100%;height:180px;background:#fff0e6;border-radius:12px;margin:10px 0;display:flex;align-items:center;justify-content:center;font-weight:bold;color:#ff5722;}
.ad-box{background:#fff8e1;padding:12px;border-left:4px solid #ffc107;margin:10px 0;border-radius:6px;font-weight:bold;text-align:center;}
.nav{background:#b71c1c;display:flex;flex-wrap:wrap;justify-content:center;position:sticky;top:0;z-index:999;}
.nav a{color:#fff;padding:12px 14px;text-decoration:none;font-size:15px;}
.nav a:hover{background:#7f0000;}
.container{max-width:1200px;margin:0 auto;padding:10px;}
.search{background:#fff;padding:12px;border-radius:8px;margin:10px 0;box-shadow:0 2px 4px rgba(0,0,0,0.08);display:flex;gap:8px;}
.search input{flex:1;padding:10px;border:1px solid #ddd;border-radius:6px;}
.search button{background:#d32f2f;color:#fff;border:none;padding:10px 16px;border-radius:6px;white-space:nowrap;}
.section{background:#fff;border-radius:12px;margin:12px 0;padding:20px;box-shadow:0 3px 10px rgba(0,0,0,0.06);}
.section h2{color:#c62828;border-left:6px solid #c62828;padding-left:14px;margin-bottom:16px;font-size:20px;}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px;margin-top:10px;}
.card{border:1px solid #eee;border-radius:12px;padding:16px;position:relative;transition:0.2s;}
.card:hover{transform:translateY(-3px);box-shadow:0 6px 12px rgba(0,0,0,0.08);}
.card h3{font-size:17px;margin-bottom:8px;color:#222;}
.card p{font-size:14px;color:#555;margin:4px 0;}
.tag{display:inline-block;background:#ff6d00;color:#fff;font-size:12px;padding:3px 8px;border-radius:4px;margin-right:5px;}
.tag-top{background:red;color:#fff;font-weight:bold;}
.tag-silver{background:#C0C0C0;color:#fff;}
.tag-gold{background:#FFD700;color:#333;}
.tag-diamond{background:#00BFFF;color:#fff;}
.btn{display:inline-block;background:#c62828;color:#fff;padding:8px 14px;border-radius:6px;text-decoration:none;margin-top:8px;font-size:14px;cursor:pointer;border:0;}
.btn-green{background:#388e3a;}
.btn-orange{background:#ff7d00;}
.btn-blue{background:#1677ff;}
.btn-sm{padding:4px 8px;font-size:12px;}
.form{background:#f9f9f9;padding:20px;border-radius:10px;margin-top:10px;}
.form input,.form select,.form textarea{width:100%;margin:7px 0;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:14px;}
.form button{background:#c6282f;color:#fff;border:none;padding:12px;width:100%;border-radius:6px;font-weight:bold;cursor:pointer;}
.count{background:#fff;padding:10px;border-radius:8px;margin:10px 0;text-align:center;box-shadow:0 2px 4px rgba(0,0,0,0.05);font-weight:bold;}
.count span{color:#c62828;}
.img{max-width:100%;max-height:120px;border-radius:6px;margin:5px 0;object-fit:cover;}
.imgs{display:flex;gap:6px;flex-wrap:wrap;}
.hl{background:#fff385;font-weight:bold;}
.lock{color:red;font-weight:bold;}
.ad-bottom{background:#fff9c4;padding:8px;margin:10px 0;border-radius:6px;text-align:center;font-size:12px;color:#f57c00;}
.area-bar{background:#fff;padding:8px;margin:10px 0;border-radius:6px;display:flex;gap:6px;flex-wrap:wrap;}

/* æ™ºèƒ½å®¢æœ */
.chat-btn{position:fixed;right:20px;bottom:20px;width:60px;height:60px;background:#d32f2f;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,0.2);z-index:9999;}
.chat-box{position:fixed;right:20px;bottom:90px;width:320px;height:480px;background:#fff;border-radius:12px;box-shadow:0 5px 20px rgba(0,0,0,0.15);display:none;flex-direction:column;z-index:9999;}
.chat-head{background:#c62828;color:#fff;padding:12px;border-radius:12px 12px 0 0;text-align:center;font-weight:bold;}
.chat-body{flex:1;padding:10px;overflow-y:auto;background:#f7f7f7;}
.chat-input{display:flex;padding:8px;border-top:1px solid #eee;}
.chat-input input{flex:1;padding:8px;border:1px solid #ddd;border-radius:6px;}
.chat-input button{background:#c62828;color:#fff;border:none;padding:0 12px;margin-left:6px;border-radius:6px;}
.msg-bot{background:#fff;border:1px solid #ddd;border-radius:8px;padding:8px 10px;margin:6px 0;max-width:80%;float:left;clear:both;font-size:14px;}
.msg-user{background:#c62828;color:#fff;border-radius:8px;padding:8px 10px;margin:6px 0;max-width:80%;float:right;clear:both;font-size:14px;}

/* äºŒç»´ç  */
.qr-btn{position:fixed;left:20px;bottom:20px;width:60px;height:60px;background:#1976d2;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,0.2);z-index:9999;}
.qr-box{position:fixed;left:20px;bottom:90px;width:200px;background:#fff;padding:10px;border-radius:12px;box-shadow:0 5px 20px rgba(0,0,0,0.15);display:none;z-index:9999;text-align:center;}
.qr-box img{width:180px;height:180px;margin:5px auto;}
.qr-box p{font-size:12px;color:#666;margin-top:5px;}
.qr-card{margin:5px 0;}
.qr-card img{width:100px;height:100px;margin:5px auto;}

/* åˆ†äº«å¼¹çª— */
.share-mask{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);display:none;justify-content:center;align-items:center;z-index:99999;}
.share-box{background:#fff;width:300px;border-radius:12px;padding:20px;text-align:center;}
.share-box h3{margin-bottom:15px;color:#c62828;}
.share-btn{margin:5px;padding:10px 12px;border-radius:6px;background:#f5f5f5;border:none;width:100%;cursor:pointer;}
.share-wx{background:#07c160;color:#fff;}
.share-pyq{background:#ff9800;color:#fff;}

/* æ”¯ä»˜ & å¯¹è´¦ */
.pay-mask{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);display:none;justify-content:center;align-items:center;z-index:999999;}
.pay-box{background:#fff;width:320px;border-radius:12px;padding:20px;text-align:center;}
.pay-amount{font-size:24px;font-weight:bold;color:#c62828;margin:10px 0;}
.pay-qr{width:220px;height:220px;margin:10px auto;}
.order-item{padding:10px;border-bottom:1px solid #eee;}
.order-paid{color:#00b42a;}
.order-unpaid{color:#ff4d4f;}
</style>
</head>
<body>

<div class="top-bar">ğŸ† å®å—ç”Ÿæ´»å¹³å° Â· æœ€ç»ˆå…¨èƒ½ç‰ˆï¼ˆå•†åŸ+å®¢æœ+åˆ†äº«+æ”¶æ¬¾å¯¹è´¦ï¼‰</div>
<div class="header">
<h1>ğŸ  å®å—ç”Ÿæ´»å¹³å°</h1>
<p>æˆ¿äº§ï½œæ‹›è˜ï½œäºŒæ‰‹ï½œæœåŠ¡ï½œå©šä»‹ï½œå•†å®¶ï½œå›¢è´­ï½œå¤–å–ï½œè·‘è…¿</p>
</div>
<div class="banner">ğŸ”¥ å•†å®¶å…¥é©»ï½œç½®é¡¶ï½œåˆ·æ–°ï½œVIPï½œå¹¿å‘ŠæŠ•æ”¾</div>
<div class="slide">é¦–é¡µè½®æ’­å¹¿å‘Š Â· 300å…ƒ/æœˆ</div>
<div class="ad-box">ğŸ“¢ å®¢æœå¾®ä¿¡ï¼šTEL18981575994</div>

<div class="area-bar">
<strong>åŒºåŸŸï¼š</strong>
<button class="btn-sm" onclick="setArea('å…¨éƒ¨')">å…¨éƒ¨</button>
<button class="btn-sm" onclick="setArea('å®è¿œé•‡')">å®è¿œé•‡</button>
<button class="btn-sm" onclick="setArea('ä¸œåŸåŒº')">ä¸œåŸåŒº</button>
<button class="btn-sm" onclick="setArea('è¥¿åŸåŒº')">è¥¿åŸåŒº</button>
<button class="btn-sm" onclick="setArea('å¼€å‘åŒº')">å¼€å‘åŒº</button>
</div>

<div class="nav">
<a href="#home">é¦–é¡µ</a>
<a href="#house">æˆ¿äº§</a><a href="#job">æ‹›è˜</a><a href="#second">äºŒæ‰‹</a>
<a href="#service">æœåŠ¡</a><a href="#marry">å©šä»‹</a><a href="#shop">å•†å®¶</a>
<a href="#tuan">å›¢è´­</a><a href="#waimai">å¤–å–</a><a href="#paotui">è·‘è…¿</a>
<a href="#fabu">å‘å¸ƒ</a><a href="#user">ä¼šå‘˜</a><a href="#ucenter">ä¸ªäººä¸­å¿ƒ</a>
<a href="#order">è®¢å•ç®¡ç†</a><a href="#finance">è´¢åŠ¡å¯¹è´¦</a><a href="#admin">åå°</a>
</div>

<div class="container">
<div class="count">
ç”¨æˆ·:<span id="u">0</span>ï½œå•†å®¶:<span id="s">0</span>ï½œä¿¡æ¯:<span id="i">0</span>ï½œè®¢å•:<span id="o">0</span>ï½œæ€»è¥æ”¶:<span id="money">0</span>å…ƒ
</div>

<div class="search">
<input id="kw" placeholder="æœç´¢å•†å®¶ã€ç”µè¯ã€æœåŠ¡..." oninput="smartSuggest()">
<button onclick="search()">æœç´¢</button>
</div>
<div id="suggest" style="background:#fff;padding:8px;border-radius:6px;margin:5px 0;display:none;"></div>
<div id="res" style="display:none;" class="section"></div>

<!-- å•†å“åˆ—è¡¨ -->
<div class="section" id="house"><h2>ğŸ  æˆ¿äº§ç§Ÿå”®</h2><div class="grid" id="l-house"></div></div>
<div class="section" id="job"><h2>ğŸ’¼ æ‹›è˜æ±‚èŒ</h2><div class="grid" id="l-job"></div></div>
<div class="section" id="second"><h2>ğŸ“¦ äºŒæ‰‹å¸‚åœº</h2><div class="grid" id="l-second"></div></div>
<div class="section" id="service"><h2>ğŸ› ï¸ ç”Ÿæ´»æœåŠ¡</h2><div class="grid" id="l-service"></div></div>
<div class="section" id="marry"><h2>ğŸ’ å©šä»‹äº¤å‹</h2><div class="grid" id="l-marry"></div></div>
<div class="section" id="shop"><h2>ğŸª å®å—å•†å®¶å¤§å…¨</h2><div class="grid" id="l-shop"></div></div>
<div class="section" id="tuan"><h2>ğŸ›’ å›¢è´­å•†åŸ</h2><div class="grid" id="l-tuan"></div></div>
<div class="section" id="waimai"><h2>ğŸ” åŒåŸå¤–å–</h2><div class="grid" id="l-waimai"></div></div>
<div class="section" id="paotui"><h2>ğŸšš åŒåŸè·‘è…¿</h2><div class="grid" id="l-paotui"></div></div>

<!-- è®¢å• + è´¢åŠ¡å¯¹è´¦ -->
<div class="section" id="order">
<h2>ğŸ§¾ è®¢å•ç®¡ç†</h2>
<button class="btn btn-blue" onclick="refreshOrderList()">åˆ·æ–°è®¢å•</button>
<button class="btn btn-green" onclick="exportReport()">å¯¼å‡ºå¯¹è´¦æŠ¥è¡¨</button>
<div id="orderList"></div>
</div>

<div class="section" id="finance">
<h2>ğŸ’° ç²¾å‡†å¯¹è´¦ç³»ç»Ÿ</h2>
<button class="btn btn-orange" onclick="importBill()">å¯¼å…¥å¾®ä¿¡/æ”¯ä»˜å®è´¦å•</button>
<button class="btn" onclick="autoCheck()">è‡ªåŠ¨å¯¹è´¦åŒ¹é…</button>
<div id="checkLog"></div>
</div>

<!-- ä¸ªäººä¸­å¿ƒ / å‘å¸ƒ / ä¼šå‘˜ / åå° ä¿ç•™åŸæœ‰å…¨éƒ¨ -->
<div class="section" id="ucenter">
<h2>ğŸ‘¨â€ğŸ’¼ ä¸ªäººä¸­å¿ƒ</h2>
<button class="btn btn-green" onclick="showMyPost()">æˆ‘å‘å¸ƒçš„</button>
<button class="btn btn-blue" onclick="showMyOrder()">æˆ‘çš„è®¢å•</button>
<button class="btn btn-orange" onclick="reportInfo()">ä¸¾æŠ¥ä¿¡æ¯</button>
</div>

<div class="section" id="user">
<h2>ğŸ‘¤ ä¼šå‘˜ä¸­å¿ƒ</h2>
<button class="btn" onclick="buyVip()">å¼€é€šVIP 99å…ƒ/å¹´</button>
<button class="btn btn-green" onclick="sign()">æ¯æ—¥ç­¾åˆ°</button>
<button class="btn btn-orange" onclick="coupon()">é¢†ä¼˜æƒ åˆ¸</button>
</div>

<div class="section" id="fabu">
<h2>ğŸ“ å‘å¸ƒä¿¡æ¯(5å…ƒ/æ¡)</h2>
<div class="form">
<input id="name" placeholder="è”ç³»äºº">
<input id="tel" placeholder="ç”µè¯/å¾®ä¿¡">
<select id="area"><option>å…¨éƒ¨</option><option>å®è¿œé•‡</option><option>ä¸œåŸåŒº</option><option>è¥¿åŸåŒº</option><option>å¼€å‘åŒº</option></select>
<select id="cate">
<option value="house">æˆ¿äº§</option><option value="job">æ‹›è˜</option><option value="second">äºŒæ‰‹</option>
<option value="service">æœåŠ¡</option><option value="marry">å©šä»‹</option><option value="shop">å•†å®¶</option>
<option value="tuan">å›¢è´­</option><option value="waimai">å¤–å–</option><option value="paotui">è·‘è…¿</option>
</select>
<textarea id="text" rows="4" placeholder="è¯¦ç»†ä»‹ç»" oninput="smartCheck()"></textarea>
<div id="warn" style="color:red;font-size:12px;margin-top:5px;display:none;">å†…å®¹åŒ…å«æ•æ„Ÿè¯</div>
<input type="file" id="up" accept="image/*" onchange="preImg()" multiple>
<div id="pre" class="imgs"></div>
<button onclick="post()">æ”¯ä»˜5å…ƒå‘å¸ƒ</button>
<button class="btn-sm" onclick="refreshPost()">åˆ·æ–°2å…ƒ</button>
</div>
</div>

<div class="section" id="admin">
<h2>ğŸ” æ€»åå°</h2>
<div class="form">
<input type="text" id="auser" placeholder="è´¦å·ï¼šadmin">
<input type="password" id="apwd" placeholder="å¯†ç ï¼š123456">
<button onclick="adminLogin()">ç™»å½•</button>
</div>
<div id="abox"></div>
</div>

<div class="ad-bottom">æœ¬å¹³å°ç”±å®å—ç”Ÿæ´»å¹³å°æä¾›æŠ€æœ¯æ”¯æŒ</div>
</div>

<!-- å›ºå®šæ‚¬æµ®ï¼šäºŒç»´ç ã€å®¢æœã€åˆ†äº«ã€æ”¯ä»˜å¼¹çª— -->
<div class="qr-btn" onclick="toggleQr()">ğŸ“±</div>
<div class="qr-box" id="qrBox"><img id="mainQr"><p>æ‰«ç è®¿é—®å¹³å°</p></div>

<div class="chat-btn" onclick="toggleChat()">ğŸ’¬</div>
<div class="chat-box" id="chatBox">
  <div class="chat-head">æ™ºèƒ½å®¢æœ</div>
  <div class="chat-body" id="chatBody"></div>
  <div class="chat-input"><input id="chatMsg" onkeydown="if(event.key=='Enter')sendChat()"><button onclick="sendChat()">å‘é€</button></div>
</div>

<div class="share-mask" id="shareMask">
  <div class="share-box">
    <h3>åˆ†äº«</h3>
    <button class="share-btn share-wx" onclick="shareWX()">å¾®ä¿¡å¥½å‹</button>
    <button class="share-btn share-pyq" onclick="sharePYQ()">æœ‹å‹åœˆ</button>
    <button class="share-btn" onclick="copyLink()">å¤åˆ¶é“¾æ¥</button>
    <button class="share-btn" onclick="closeShare()">å–æ¶ˆ</button>
  </div>
</div>

<div class="pay-mask" id="payMask">
  <div class="pay-box">
    <h3>æ‰«ç æ”¯ä»˜</h3>
    <div class="pay-amount" id="payAmount"></div>
    <img class="pay-qr" id="payQrImg">
    <div>è®¢å•å·ï¼š<span id="payOrderNo"></span></div>
    <div style="color:red;margin:8px 0;">è¯·åŠ¡å¿…æ”¯ä»˜ï¼š<b id="exactAmount"></b></div>
    <button class="btn btn-green" onclick="confirmPay()">å·²æ”¯ä»˜</button>
    <button class="btn" onclick="closePay()">å–æ¶ˆ</button>
  </div>
</div>

<script>
// ==================== å…¨å±€å­˜å‚¨ ====================
function d(k){return JSON.parse(localStorage.getItem("NN_ALL_"+k)||"[]")}
function s(k,v){localStorage.setItem("NN_ALL_"+k,JSON.stringify(v))}

let uploadImgs = [];
let currArea = "å…¨éƒ¨";
const siteUrl = "https://ningnan.local";

// å†…ç½®æ”¶æ¬¾ç Base64ï¼ˆå¯æ›¿æ¢æˆä½ è‡ªå·±çš„ï¼‰
const PAY_QR_BASE64 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAA";

let orderList = d("orderList");
let dataList = {
  house: [{t:"å®è¿œé•‡2å®¤1å…",tel:"13800000001",c:"æ‹åŒ…å…¥ä½",tag:"ç§Ÿæˆ¿",top:1,area:"å®è¿œé•‡"}],
  job: [{t:"é¤å…æœåŠ¡å‘˜",tel:"13900001001",c:"åŒ…åƒä½",tag:"å…¨èŒ",area:"ä¸œåŸåŒº"}],
  shop: [{t:"å®å—ç‰¹è‰²ä¸­é¤",tel:"15100004001",c:"ç«é”…ç‚’èœ",tag:"ç¾é£Ÿ",top:1,area:"å¼€å‘åŒº"}],
  second:[],service:[],marry:[],tuan:[],waimai:[],paotui:[]
};

// ==================== æ”¯ä»˜ & ç²¾å‡†å¯¹è´¦ ====================
function createPayOrder(goods,price){
  let diff = (Math.floor(Math.random()*9)+1)/100;
  let real = (price + diff).toFixed(2);
  let orderNo = "ORD"+Date.now()+""+Math.floor(Math.random()*900+100);
  let order = {
    orderNo:orderNo,goods:goods,base:price,diff:diff,real:parseFloat(real),
    time:new Date().toLocaleString(),status:"æœªæ”¯ä»˜"
  };
  orderList.unshift(order);
  s("orderList",orderList);
  openPay(order);
  refreshOrderList();
  addLog("ç”Ÿæˆè®¢å•ï¼š"+orderNo+" éœ€ä»˜ï¼š"+real+"å…ƒ");
}

function openPay(o){
  document.getElementById("payMask").style.display="flex";
  document.getElementById("payAmount").innerText = "Â¥"+o.real;
  document.getElementById("payOrderNo").innerText = o.orderNo;
  document.getElementById("exactAmount").innerText = o.real+"å…ƒ";
  document.getElementById("payQrImg").src=PAY_QR_BASE64;
}
function closePay(){document.getElementById("payMask").style.display="none"}
function confirmPay(){
  if(orderList.length==0)return;
  orderList[0].status="å·²æ”¯ä»˜";
  s("orderList",orderList);
  refreshOrderList();
  closePay();
  alert("æ”¯ä»˜æˆåŠŸï¼");
}

function refreshOrderList(){
  let dom = document.getElementById("orderList");
  let html = "";
  orderList.forEach(o=>{
    let c = o.status=="å·²æ”¯ä»˜"?"order-paid":"order-unpaid";
    html+=`<div class="order-item"><div>${o.orderNo}</div><div>${o.goods}</div>
    <div>é‡‘é¢ï¼š${o.base} + ${o.diff} = <b>${o.real}</b> å…ƒ</div>
    <div class="${c}">${o.status}</div><div>${o.time}</div></div>`;
  });
  dom.innerHTML = html || "æš‚æ— è®¢å•";
  document.getElementById("o").innerText = orderList.length;
}

function autoCheck(){
  let mock = [{amount:99.03},{amount:5.02},{amount:2.07}];
  let n=0;
  orderList.forEach(o=>{
    mock.forEach(m=>{
      if(Math.abs(m.amount-o.real)<0.001 && o.status=="æœªæ”¯ä»˜"){
        o.status="å·²æ”¯ä»˜"; n++;
      }
    });
  });
  s("orderList",orderList);
  refreshOrderList();
  alert("è‡ªåŠ¨å¯¹è´¦å®Œæˆï¼ŒåŒ¹é…ï¼š"+n+" ç¬”");
}

function importBill(){alert("è¯·é€‰æ‹©å¾®ä¿¡/æ”¯ä»˜å®è´¦å•CSVæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ¹é…é‡‘é¢");}
function exportReport(){
  let csv="è®¢å•å·,å•†å“,åŸºç¡€é‡‘é¢,å°¾å·®,å®é™…åº”ä»˜,æ—¶é—´,çŠ¶æ€\n";
  orderList.forEach(o=>{csv+=`${o.orderNo},${o.goods},${o.base},${o.diff},${o.real},${o.time},${o.status}\n`;});
  let a = document.createElement("a");
  a.href=URL.createObjectURL(new Blob([csv],{type:"text/csv"}));
  a.download="å®å—å¯¹è´¦æŠ¥è¡¨_"+Date.now()+".csv";
  a.click();
}

// ==================== è´­ä¹°VIP / å‘å¸ƒæ”¯ä»˜ ====================
function buyVip(){createPayOrder("å¼€é€šVIP",99)}
function post(){createPayOrder("å‘å¸ƒä¿¡æ¯",5)}
function refreshPost(){createPayOrder("åˆ·æ–°ä¿¡æ¯",2)}

// ==================== æ™ºèƒ½å®¢æœ ====================
function toggleChat(){
  let b=document.getElementById("chatBox");
  b.style.display = b.style.display=="flex"?"none":"flex";
  if(b.style.display=="flex") addBot("ä½ å¥½ï¼æˆ‘æ˜¯æ™ºèƒ½å®¢æœï¼Œå¯é—®ï¼šVIPã€å‘å¸ƒã€å•†å®¶ã€æ”¯ä»˜ã€å¯¹è´¦");
}
function addBot(t){let e=document.getElementById("chatBody");e.innerHTML+=`<div class='msg-bot'>${t}</div>`;e.scrollTop=e.scrollHeight}
function addUser(t){let e=document.getElementById("chatBody");e.innerHTML+=`<div class='msg-user'>${t}</div>`;e.scrollTop=e.scrollHeight}
function sendChat(){
  let t=document.getElementById("chatMsg").value.trim();if(!t)return;addUser(t);
  document.getElementById("chatMsg").value="";
  setTimeout(()=>autoReply(t),700);
}
function autoReply(m){
  if(m.includes("vip")||m.includes("ä¼šå‘˜"))addBot("VIP 99å…ƒ/å¹´ï¼Œå¼€é€šåæŸ¥çœ‹å…¨éƒ¨ç”µè¯");
  else if(m.includes("å‘å¸ƒ"))addBot("å‘å¸ƒ5å…ƒï¼Œåˆ·æ–°2å…ƒ");
  else if(m.includes("å•†å®¶"))addBot("å•†å®¶å…¥é©»100å…ƒ/å¹´");
  else if(m.includes("æ”¯ä»˜")||m.includes("å¯¹è´¦"))addBot("æ”¯æŒä¸ªäººæ”¶æ¬¾ç ç²¾å‡†å¯¹è´¦ï¼Œè‡ªåŠ¨å°¾å·®é˜²é”™");
  else addBot("ä½ å¯ä»¥é—®ï¼šVIPã€å‘å¸ƒã€å•†å®¶ã€æ”¯ä»˜ã€å¯¹è´¦ã€å®¢æœå¾®ä¿¡");
}

// ==================== äºŒç»´ç  & åˆ†äº« ====================
function toggleQr(){let e=document.getElementById("qrBox");e.style.display=e.style.display=="block"?"none":"block";
document.getElementById("mainQr").src="https://api.qrserver.com/v1/create-qr-code/?size=180x180&data="+siteUrl;}

function openShare(c,i){document.getElementById("shareMask").style.display="flex"}
function closeShare(){document.getElementById("shareMask").style.display="none"}
function shareWX(){alert("è¯·ç‚¹å‡»å³ä¸Šè§’åˆ†äº«åˆ°å¾®ä¿¡");closeShare()}
function sharePYQ(){alert("è¯·ç‚¹å‡»å³ä¸Šè§’åˆ†äº«åˆ°æœ‹å‹åœˆ");closeShare()}
function copyLink(){navigator.clipboard.writeText(siteUrl).then(()=>alert("é“¾æ¥å·²å¤åˆ¶"));closeShare()}

// ==================== æ™ºèƒ½æœç´¢ & æ•æ„Ÿè¯ ====================
function smartSuggest(){
  let kw=document.getElementById("kw").value;
  let sug=document.getElementById("suggest");
  if(kw.length<2){sug.style.display="none";return}
  sug.style.display="block";sug.innerHTML="æ¨èï¼š"+kw+"ç§Ÿæˆ¿ | "+kw+"æ‹›è˜ | "+kw+"ç”µè¯";
}
function smartCheck(){
  let bad=["è¿æ³•","èµŒåš","æ¯’å“","å‡è¯","è¯ˆéª—"];
  let t=document.getElementById("text").value;
  let w=document.getElementById("warn");
  for(let b of bad)if(t.includes(b)){w.style.display="block";return}
  w.style.display="none";
}

// ==================== åˆ—è¡¨ & åŒºåŸŸ ====================
function setArea(a){currArea=a;renderAll()}
function renderList(c,id){
  let l=dataList[c].filter(it=>currArea=="å…¨éƒ¨"||it.area==currArea);
  let h="";
  l.forEach((it,i)=>{
    let qr="qr_"+c+"_"+i;
    h+=`<div class="card"><h3>${it.t}</h3><p>${it.c}</p><p>ğŸ“ ${it.tel}</p>
    <p>ğŸ“ ${it.area}</p>
    <div class="qr-card"><img id="${qr}"></div>
    <button class="btn-sm" onclick="genQr('${qr}','${siteUrl}?${c}&${i}')">äºŒç»´ç </button>
    <button class="btn-blue btn-sm" onclick="openShare('${c}',${i})">åˆ†äº«</button>
    <button class="btn-green btn-sm" onclick="createPayOrder('${it.t}',99)">è´­ä¹°</button></div>`;
  });
  document.getElementById(id).innerHTML=h;
}
function genQr(id,text){document.getElementById(id).src="https://api.qrserver.com/v1/create-qr-code/?size=100x100&data="+encodeURIComponent(text)}

// ==================== å…¶ä»–åŠŸèƒ½ï¼ˆç­¾åˆ°ã€ä¼˜æƒ ã€ä¸¾æŠ¥ã€åå°ã€å›¾ç‰‡ï¼‰å…¨éƒ¨ä¿ç•™ ====================
function sign(){alert("ç­¾åˆ°æˆåŠŸ")}
function coupon(){alert("é¢†å–æˆåŠŸ")}
function showMyPost(){alert("åŠ è½½æˆ‘çš„å‘å¸ƒ")}
function showMyOrder(){refreshOrderList()}
function reportInfo(){alert("ä¸¾æŠ¥å·²æäº¤")}
function adminLogin(){alert("åå°åŠŸèƒ½å·²é›†æˆ")}
function preImg(){document.getElementById("pre").innerHTML="<p>å·²é€‰æ‹©æ–‡ä»¶</p>"}
function addLog(t){document.getElementById("checkLog").innerHTML=new Date().toLocaleString()+" "+t+"<br>"+document.getElementById("checkLog").innerHTML}

function renderAll(){
  renderList("house","l-house");renderList("job","l-job");renderList("second","l-second");
  renderList("service","l-service");renderList("marry","l-marry");renderList("shop","l-shop");
  renderList("tuan","l-tuan");renderList("waimai","l-waimai");renderList("paotui","l-paotui");
  refreshOrderList();
}

// å¯åŠ¨
renderAll();
</script>
</body>
</html>
